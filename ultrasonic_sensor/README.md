# 超音波感測器互動專案

最後更新：2025年4月9日

這是一個使用HC-SR04超音波感測器的Arduino互動專案。專案包含兩個版本：基礎版（v1）提供距離感測與警告功能，進階版（v2）則增加了互動音樂播放功能。

## 版本說明

### 基礎版（v1）
距離感測與警告系統，當物體接近時觸發LED指示燈並發出警告聲響，距離越近聲音頻率越高。

### 進階版（v2）
在基礎版功能上新增了音樂互動功能：
- 當物體距離小於5公分時，切換音樂播放狀態（開始/停止）
- 支援多首音樂：小星星、天空之城、聖誕鈴聲
- 透過按鈕切換不同曲目
- LED燈光隨著音樂節奏漸明漸暗
- 使用非阻塞式程式設計，提高系統響應性

## 硬體需求

- Arduino Uno/Nano 開發板
- HC-SR04超音波感測器
- LED (發光二極體)
- 蜂鳴器模組
- 按鈕開關（v2版本需要）
- 連接線

## 接線說明

- VCC 接 Arduino 5V
- GND 接 Arduino GND
- TRIG 接 Arduino PIN 9
- ECHO 接 Arduino PIN 10
- LED 正極接 Arduino PIN 3
- LED 負極接 Arduino GND（建議串聯220Ω電阻）
- 蜂鳴器正極接 Arduino PIN 11
- 蜂鳴器負極接 Arduino GND
- 按鈕一端接 Arduino PIN 2（v2版本）
- 按鈕另一端接 GND（v2版本）

## 功能說明

### 基礎功能（兩個版本皆有）

1. 距離測量：
   - 每200毫秒測量一次距離
   - 使用5個樣本進行平均值計算，提高測量穩定性
   - 測量範圍：2-400公分

2. LED指示：
   - 當測量距離小於20公分時，LED會亮起
   - 當測量距離大於或等於20公分時，LED會熄滅

3. 資料輸出：
   - 透過序列埠輸出平均距離值（單位：公分）
   - 更新頻率：每200毫秒一次

### 進階功能（v2版本特有）

1. 多曲目音樂播放：
   - 支援三首預設曲目：小星星、天空之城、聖誕鈴聲
   - 按鈕切換曲目功能
   - 距離感測控制播放/暫停
   - 完整的八度音階，從 C4 (262Hz) 到 G5 (784Hz)

2. 動態燈光效果：
   - LED使用PWM輸出，產生漸明漸暗效果
   - 燈光變化週期為2秒
   - 使用正弦波控制產生平滑的呼吸燈效果

3. 非阻塞式設計：
   - 使用millis()函數進行時間控制
   - 按鈕防彈跳處理
   - 避免使用delay()造成的系統延遲
   - 提供更好的互動體驗和響應性

## 使用方法

1. 依照接線說明連接硬體
2. 選擇所需版本的程式碼（v1或v2）上傳至Arduino開發板
3. 開啟序列監視器（鮑率設定為9600）
4. v2版本：
   - 按下按鈕切換歌曲
   - 手掌靠近感測器（<5cm）切換播放狀態
   - 觀察LED呼吸效果
5. 觀察測量結果與互動效果

## 注意事項

- HC-SR04的測量範圍為2-400公分
- 確保感測器前方沒有障礙物影響測量
- LED需要串聯適當的限流電阻（建議使用220Ω）
- 測量結果為5個樣本的平均值，可提供更穩定的距離讀數
- v2版本中的音樂速度和LED效果可在程式碼中調整
- 建議使用5V供電以確保蜂鳴器有足夠的驅動電流
- 按鈕需要接地以確保正常運作